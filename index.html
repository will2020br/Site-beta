<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoundScroll - TikTok de MÃºsica</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 100%);
            color: white;
            overflow: hidden;
            height: 100vh;
        }
        
        .music-container {
            height: 100vh;
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            position: relative;
        }
        
        .music-track {
            height: 100vh;
            width: 100%;
            scroll-snap-align: start;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background: linear-gradient(180deg, rgba(15,15,15,0.95) 0%, rgba(26,26,46,0.95) 100%);
        }
        
        .track-wrapper {
            width: 100%;
            max-width: 600px;
            height: auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .player-container {
            background: rgba(30, 30, 46, 0.8);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .track-info {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .track-artwork {
            width: 200px;
            height: 200px;
            border-radius: 15px;
            margin: 0 auto 25px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
            background: linear-gradient(45deg, #ff5500, #ff9500);
        }
        
        .track-artwork img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .track-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff5500, #ff9500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .track-artist {
            font-size: 18px;
            color: #cccccc;
            margin-bottom: 5px;
        }
        
        .track-album {
            font-size: 14px;
            color: #888;
            font-style: italic;
        }
        
        .embed-wrapper {
            position: relative;
            width: 100%;
            border-radius: 15px;
            overflow: hidden;
            background: #1e1e2e;
        }
        
        .soundcloud-embed {
            width: 100%;
            height: 200px;
            border: none;
            border-radius: 15px;
        }
        
        .track-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        .control-btn {
            background: rgba(255, 85, 0, 0.2);
            border: 2px solid rgba(255, 85, 0, 0.3);
            color: #ff5500;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: rgba(255, 85, 0, 0.3);
            transform: scale(1.1);
        }
        
        .control-btn.active {
            background: #ff5500;
            color: white;
        }
        
        .track-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            font-size: 14px;
            color: #aaa;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .stat-count {
            font-size: 18px;
            font-weight: bold;
            color: white;
        }
        
        .waveform {
            width: 100%;
            height: 60px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-top: 25px;
            position: relative;
            overflow: hidden;
        }
        
        .waveform-bar {
            position: absolute;
            bottom: 0;
            width: 4px;
            background: #ff5500;
            border-radius: 2px;
            animation: wavePulse 1.5s infinite ease-in-out;
        }
        
        @keyframes wavePulse {
            0%, 100% { height: 20%; }
            50% { height: 80%; }
        }
        
        .now-playing {
            position: absolute;
            top: 30px;
            left: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #ff5500;
            z-index: 10;
        }
        
        .now-playing-dot {
            width: 10px;
            height: 10px;
            background: #ff5500;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .nav-indicators {
            position: fixed;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 100;
        }
        
        .nav-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .nav-dot:hover {
            transform: scale(1.3);
        }
        
        .nav-dot.active {
            background: #ff5500;
            transform: scale(1.3);
            box-shadow: 0 0 15px rgba(255, 85, 0, 0.5);
        }
        
        .nav-dot.active::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 1px solid #ff5500;
            border-radius: 50%;
            animation: ripple 2s infinite;
        }
        
        @keyframes ripple {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        .add-track-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #ff5500;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(255, 85, 0, 0.4);
            transition: transform 0.3s;
        }
        
        .add-track-btn:hover {
            transform: scale(1.1);
        }
        
        .volume-control {
            position: fixed;
            bottom: 30px;
            left: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 100;
        }
        
        .volume-slider {
            width: 100px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #ff5500;
            cursor: pointer;
        }
        
        .genre-tag {
            display: inline-block;
            padding: 5px 15px;
            background: rgba(255, 85, 0, 0.1);
            border: 1px solid rgba(255, 85, 0, 0.3);
            border-radius: 20px;
            font-size: 12px;
            color: #ff9500;
            margin: 5px;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: #ff5500;
            width: 0%;
            transition: width 0.1s linear;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            border: 1px solid rgba(255, 85, 0, 0.2);
        }
        
        .modal h2 {
            color: #ff5500;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .platform-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .platform-btn {
            flex: 1;
            min-width: 100px;
            padding: 12px;
            background: rgba(255, 85, 0, 0.1);
            border: 1px solid rgba(255, 85, 0, 0.3);
            color: #ff9500;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .platform-btn:hover {
            background: rgba(255, 85, 0, 0.2);
        }
        
        .platform-btn.active {
            background: #ff5500;
            color: white;
        }
        
        .embed-input {
            width: 100%;
            height: 200px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 85, 0, 0.3);
            border-radius: 10px;
            color: white;
            font-family: monospace;
            resize: vertical;
            margin-bottom: 20px;
        }
        
        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }
        
        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .modal-btn.cancel {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .modal-btn.add {
            background: #ff5500;
            color: white;
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .track-title {
                font-size: 22px;
            }
            
            .track-artist {
                font-size: 16px;
            }
            
            .track-artwork {
                width: 150px;
                height: 150px;
            }
            
            .now-playing {
                top: 20px;
                left: 20px;
                font-size: 12px;
            }
            
            .nav-indicators {
                right: 15px;
            }
            
            .add-track-btn {
                bottom: 20px;
                right: 20px;
            }
            
            .volume-control {
                bottom: 20px;
                left: 20px;
            }
        }
        
        /* Hide scrollbar */
        .music-container::-webkit-scrollbar {
            width: 0;
            background: transparent;
        }
        
        /* Equalizer animation for active track */
        .equalizer {
            display: none;
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            z-index: 10;
        }
        
        .equalizer-bar {
            position: absolute;
            bottom: 0;
            width: 4px;
            background: #ff5500;
            border-radius: 2px;
            animation: equalizer 1.5s infinite ease-in-out;
        }
        
        .equalizer-bar:nth-child(1) { left: 0; animation-delay: 0s; }
        .equalizer-bar:nth-child(2) { left: 8px; animation-delay: 0.1s; }
        .equalizer-bar:nth-child(3) { left: 16px; animation-delay: 0.2s; }
        .equalizer-bar:nth-child(4) { left: 24px; animation-delay: 0.3s; }
        .equalizer-bar:nth-child(5) { left: 32px; animation-delay: 0.4s; }
        
        @keyframes equalizer {
            0%, 100% { height: 20%; }
            50% { height: 100%; }
        }
        
        .track-duration {
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
            color: #888;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Now Playing Indicator -->
    <div class="now-playing">
        <div class="now-playing-dot"></div>
        <span id="nowPlayingText">Tocando agora</span>
    </div>
    
    <!-- Music Container -->
    <div class="music-container" id="musicContainer">
        <!-- Tracks will be loaded here -->
    </div>
    
    <!-- Navigation Dots -->
    <div class="nav-indicators" id="navIndicators"></div>
    
    <!-- Volume Control -->
    <div class="volume-control">
        <i class="fas fa-volume-up" style="color: #ff5500;"></i>
        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
    </div>
    
    <!-- Add Track Button -->
    <button class="add-track-btn" onclick="showAddModal()">
        <i class="fas fa-plus"></i>
    </button>
    
    <!-- Add Track Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <h2><i class="fas fa-music"></i> Adicionar Nova MÃºsica</h2>
            
            <div class="platform-selector">
                <button class="platform-btn active" onclick="selectPlatform('soundcloud')">SoundCloud</button>
                <button class="platform-btn" onclick="selectPlatform('spotify')">Spotify</button>
                <button class="platform-btn" onclick="selectPlatform('youtube')">YouTube</button>
                <button class="platform-btn" onclick="selectPlatform('custom')">Customizado</button>
            </div>
            
            <textarea class="embed-input" id="embedInput" placeholder="Cole o cÃ³digo embed aqui...">
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/soundcloud%253Atracks%253A2181446367&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><a href="https://soundcloud.com/aka-716226817" title="zainka." target="_blank" style="color: #cccccc; text-decoration: none;">zainka.</a> Â· <a href="https://soundcloud.com/aka-716226817/taylor-swift-the-fate-of" title="Taylor Swift - The Fate of Ophelia" target="_blank" style="color: #cccccc; text-decoration: none;">Taylor Swift - The Fate of Ophelia</a></div></textarea>
            
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="hideAddModal()">Cancelar</button>
                <button class="modal-btn add" onclick="addNewTrack()">Adicionar MÃºsica</button>
            </div>
        </div>
    </div>

    <script>
        // Initial music tracks data
        const tracks = [
            {
                id: 1,
                embedCode: `<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/soundcloud%253Atracks%253A2181446367&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><a href="https://soundcloud.com/aka-716226817" title="zainka." target="_blank" style="color: #cccccc; text-decoration: none;">zainka.</a> Â· <a href="https://soundcloud.com/aka-716226817/taylor-swift-the-fate-of" title="Taylor Swift - The Fate of Ophelia" target="_blank" style="color: #cccccc; text-decoration: none;">Taylor Swift - The Fate of Ophelia</a></div>`,
                title: "The Fate of Ophelia",
                artist: "Taylor Swift",
                album: "Midnights (Special Edition)",
                artwork: "https://i.scdn.co/image/ab67616d00001e02/8c8b428e50c733b1a6fdcf16ac8ca3c6f3e7b43a",
                likes: "45.2K",
                plays: "1.2M",
                duration: "3:45",
                genre: ["Pop", "Alternative"],
                platform: "soundcloud"
            },
            {
                id: 2,
                embedCode: `<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/293&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>`,
                title: "Blinding Lights",
                artist: "The Weeknd",
                album: "After Hours",
                artwork: "https://i.scdn.co/image/ab67616d00001e028086e2e00702709e3f44e574",
                likes: "125K",
                plays: "2.5M",
                duration: "3:22",
                genre: ["Synth-pop", "R&B"],
                platform: "soundcloud"
            },
            {
                id: 3,
                embedCode: `<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/499567854&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>`,
                title: "good 4 u",
                artist: "Olivia Rodrigo",
                album: "SOUR",
                artwork: "https://i.scdn.co/image/ab67616d00001e02/3d1b5b8b8e5d5c5c5c5c5c5c5c5c5c5c5c5c5c5c",
                likes: "89.7K",
                plays: "1.8M",
                duration: "2:58",
                genre: ["Pop Punk", "Alternative"],
                platform: "soundcloud"
            },
            {
                id: 4,
                embedCode: `<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/671904901&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>`,
                title: "Levitating",
                artist: "Dua Lipa",
                album: "Future Nostalgia",
                artwork: "https://i.scdn.co/image/ab67616d00001e02/2d7b5c2e5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c5c",
                likes: "156K",
                plays: "3.2M",
                duration: "3:24",
                genre: ["Disco", "Pop"],
                platform: "soundcloud"
            }
        ];
        
        const musicContainer = document.getElementById('musicContainer');
        const navIndicators = document.getElementById('navIndicators');
        const addModal = document.getElementById('addModal');
        const embedInput = document.getElementById('embedInput');
        const volumeSlider = document.getElementById('volumeSlider');
        const nowPlayingText = document.getElementById('nowPlayingText');
        
        let currentTrackIndex = 0;
        let trackCounter = tracks.length + 1;
        let currentPlatform = 'soundcloud';
        let activePlayers = new Map();
        
        // Initialize the music feed
        function initMusicFeed() {
            musicContainer.innerHTML = '';
            createTrackElements();
            createNavIndicators();
            updateNowPlaying();
        }
        
        // Create track elements
        function createTrackElements() {
            tracks.forEach((track, index) => {
                const trackElement = createTrackElement(track, index);
                musicContainer.appendChild(trackElement);
            });
        }
        
        // Create a single track element
        function createTrackElement(track, index) {
            const trackElement = document.createElement('div');
            trackElement.className = 'music-track';
            trackElement.dataset.id = track.id;
            trackElement.dataset.index = index;
            
            trackElement.innerHTML = `
                <div class="track-wrapper">
                    <div class="track-info">
                        <div class="track-artwork">
                            <img src="${track.artwork}" alt="${track.title}" 
                                 onerror="this.src='https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=400&fit=crop'">
                        </div>
                        <h1 class="track-title">${track.title}</h1>
                        <p class="track-artist">${track.artist}</p>
                        <p class="track-album">${track.album}</p>
                        <div class="genre-tags">
                            ${track.genre.map(g => `<span class="genre-tag">${g}</span>`).join('')}
                        </div>
                        <div class="track-duration">${track.duration}</div>
                    </div>
                    
                    <div class="player-container">
                        <div class="embed-wrapper" id="embed-wrapper-${track.id}">
                            ${track.embedCode}
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-${track.id}"></div>
                        </div>
                        
                        <div class="track-controls">
                            <button class="control-btn" onclick="skipBackward(${track.id})">
                                <i class="fas fa-backward"></i>
                            </button>
                            <button class="control-btn play-btn" id="play-btn-${track.id}" onclick="togglePlay(${track.id})">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="control-btn" onclick="skipForward(${track.id})">
                                <i class="fas fa-forward"></i>
                            </button>
                            <button class="control-btn" onclick="toggleLike(${track.id})">
                                <i class="far fa-heart"></i>
                            </button>
                        </div>
                        
                        <div class="track-stats">
                            <div class="stat-item">
                                <div class="stat-count" id="likes-count-${track.id}">${track.likes}</div>
                                <span>Curtidas</span>
                            </div>
                            <div class="stat-item">
                                <div class="stat-count" id="plays-count-${track.id}">${track.plays}</div>
                                <span>Plays</span>
                            </div>
                        </div>
                        
                        <div class="waveform" id="waveform-${track.id}">
                            ${Array.from({length: 40}, (_, i) => 
                                `<div class="waveform-bar" style="left: ${i * 10}px; animation-delay: ${i * 0.05}s;"></div>`
                            ).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="equalizer" id="equalizer-${track.id}">
                    ${Array.from({length: 5}, (_, i) => 
                        `<div class="equalizer-bar"></div>`
                    ).join('')}
                </div>
            `;
            
            // Process embed after adding to DOM
            setTimeout(() => {
                processSoundCloudEmbed(trackElement, track.id);
            }, 100);
            
            return trackElement;
        }
        
        // Process SoundCloud embed
        function processSoundCloudEmbed(trackElement, trackId) {
            const embedWrapper = trackElement.querySelector(`#embed-wrapper-${trackId}`);
            const iframe = embedWrapper.querySelector('iframe');
            
            if (iframe) {
                iframe.classList.add('soundcloud-embed');
                
                // Add event listener for iframe messages
                window.addEventListener('message', (e) => {
                    try {
                        if (e.origin === 'https://w.soundcloud.com') {
                            const data = JSON.parse(e.data);
                            if (data.method === 'getCurrentTime') {
                                updateProgress(trackId, data.value);
                            }
                        }
                    } catch (err) {
                        // Ignore non-JSON messages
                    }
                });
                
                // Store player reference
                activePlayers.set(trackId, iframe);
            }
        }
        
        // Create navigation indicators
        function createNavIndicators() {
            navIndicators.innerHTML = '';
            tracks.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'nav-dot';
                dot.dataset.index = index;
                dot.onclick = () => scrollToTrack(index);
                navIndicators.appendChild(dot);
            });
        }
        
        // Scroll to specific track
        function scrollToTrack(index) {
            const trackElements = document.querySelectorAll('.music-track');
            if (trackElements[index]) {
                trackElements[index].scrollIntoView({ behavior: 'smooth' });
                currentTrackIndex = index;
                updateActiveIndicator();
                updateNowPlaying();
            }
        }
        
        // Update active navigation indicator
        function updateActiveIndicator() {
            const dots = document.querySelectorAll('.nav-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentTrackIndex);
            });
        }
        
        // Update "Now Playing" text
        function updateNowPlaying() {
            const currentTrack = tracks[currentTrackIndex];
            nowPlayingText.textContent = `${currentTrack.artist} - ${currentTrack.title}`;
            
            // Show equalizer for current track
            document.querySelectorAll('.equalizer').forEach(eq => eq.style.display = 'none');
            const currentEqualizer = document.getElementById(`equalizer-${currentTrack.id}`);
            if (currentEqualizer) {
                currentEqualizer.style.display = 'block';
            }
        }
        
        // Handle scroll to detect current track
        function handleScroll() {
            const trackElements = document.querySelectorAll('.music-track');
            const containerRect = musicContainer.getBoundingClientRect();
            
            trackElements.forEach((track, index) => {
                const rect = track.getBoundingClientRect();
                
                if (rect.top >= containerRect.top && rect.bottom <= containerRect.bottom) {
                    if (currentTrackIndex !== index) {
                        currentTrackIndex = index;
                        updateActiveIndicator();
                        updateNowPlaying();
                        autoPlayCurrentTrack();
                    }
                }
            });
        }
        
        // Auto-play current track when it becomes visible
        function autoPlayCurrentTrack() {
            const currentTrack = tracks[currentTrackIndex];
            const iframe = activePlayers.get(currentTrack.id);
            
            if (iframe && iframe.contentWindow) {
                try {
                    // Send play command to SoundCloud player
                    iframe.contentWindow.postMessage(JSON.stringify({
                        method: 'play'
                    }), 'https://w.soundcloud.com');
                } catch (err) {
                    console.log('Auto-play not supported for this embed');
                }
            }
        }
        
        // Track control functions
        function togglePlay(trackId) {
            const iframe = activePlayers.get(trackId);
            const playBtn = document.getElementById(`play-btn-${trackId}`);
            const playIcon = playBtn.querySelector('i');
            
            if (iframe && iframe.contentWindow) {
                try {
                    iframe.contentWindow.postMessage(JSON.stringify({
                        method: 'toggle'
                    }), 'https://w.soundcloud.com');
                    
                    // Toggle button icon
                    if (playIcon.classList.contains('fa-play')) {
                        playIcon.classList.replace('fa-play', 'fa-pause');
                        playBtn.classList.add('active');
                    } else {
                        playIcon.classList.replace('fa-pause', 'fa-play');
                        playBtn.classList.remove('active');
                    }
                } catch (err) {
                    console.log('Play control not supported');
                }
            }
        }
        
        function skipBackward(trackId) {
            const iframe = activePlayers.get(trackId);
            if (iframe && iframe.contentWindow) {
                try {
                    iframe.contentWindow.postMessage(JSON.stringify({
                        method: 'seekTo',
                        value: 0
                    }), 'https://w.soundcloud.com');
                } catch (err) {
                    console.log('Skip control not supported');
                }
            }
        }
        
        function skipForward(trackId) {
            // For SoundCloud, we can't skip forward directly
            // This would need custom implementation
            console.log('Skip forward not directly supported by SoundCloud API');
        }
        
        function toggleLike(trackId) {
            const likeCount = document.getElementById(`likes-count-${trackId}`);
            const track = tracks.find(t => t.id === trackId);
            
            if (track) {
                let currentLikes = likeCount.textContent;
                if (currentLikes.endsWith('K')) {
                    const num = parseFloat(currentLikes);
                    likeCount.textContent = (num + 0.1).toFixed(1) + 'K';
                } else {
                    const num = parseInt(currentLikes.replace('K', '')) || 0;
                    likeCount.textContent = (num + 1) + 'K';
                }
            }
        }
        
        // Update progress bar
        function updateProgress(trackId, progress) {
            const progressFill = document.getElementById(`progress-${trackId}`);
            if (progressFill) {
                progressFill.style.width = `${progress}%`;
            }
        }
        
        // Modal functions
        function showAddModal() {
            addModal.style.display = 'flex';
            selectPlatform('soundcloud');
        }
        
        function hideAddModal() {
            addModal.style.display = 'none';
        }
        
        function selectPlatform(platform) {
            currentPlatform = platform;
            
            // Update platform buttons
            document.querySelectorAll('.platform-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Set placeholder based on platform
            switch(platform) {
                case 'soundcloud':
                    embedInput.placeholder = "Cole o cÃ³digo embed do SoundCloud...";
                    break;
                case 'spotify':
                    embedInput.placeholder = "Cole o cÃ³digo embed do Spotify...";
                    break;
                case 'youtube':
                    embedInput.placeholder = "Cole o cÃ³digo embed do YouTube Music...";
                    break;
                default:
                    embedInput.placeholder = "Cole qualquer cÃ³digo embed de mÃºsica...";
            }
        }
        
        // Add new track
        function addNewTrack() {
            const embedCode = embedInput.value.trim();
            
            if (!embedCode) {
                alert('Por favor, cole um cÃ³digo embed vÃ¡lido!');
                return;
            }
            
            const newTrack = {
                id: trackCounter++,
                embedCode: embedCode,
                title: prompt("TÃ­tulo da mÃºsica:", "Nova MÃºsica") || "Nova MÃºsica",
                artist: prompt("Artista:", "Artista Desconhecido") || "Artista Desconhecido",
                album: prompt("Ãlbum:", "Single") || "Single",
                artwork: prompt("URL da capa (opcional):", "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=400&fit=crop") || "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=400&fit=crop",
                likes: "0",
                plays: "0",
                duration: "?:??",
                genre: prompt("GÃªneros (separados por vÃ­rgula):", "Pop").split(',').map(g => g.trim()),
                platform: currentPlatform
            };
            
            tracks.push(newTrack);
            const trackElement = createTrackElement(newTrack, tracks.length - 1);
            musicContainer.appendChild(trackElement);
            createNavIndicators();
            
            hideAddModal();
            
            // Scroll to new track
            setTimeout(() => {
                scrollToTrack(tracks.length - 1);
            }, 300);
        }
        
        // Volume control
        volumeSlider.addEventListener('input', (e) => {
            const volume = e.target.value;
            // Note: Controlling volume of iframes from other domains is restricted
            // This is a visual control only
            console.log('Volume set to:', volume + '%');
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowUp':
                    e.preventDefault();
                    if (currentTrackIndex > 0) scrollToTrack(currentTrackIndex - 1);
                    break;
                case 'ArrowDown':
                    e.preventDefault();
                    if (currentTrackIndex < tracks.length - 1) scrollToTrack(currentTrackIndex + 1);
                    break;
                case ' ':
                    e.preventDefault();
                    const currentTrack = tracks[currentTrackIndex];
                    if (currentTrack) togglePlay(currentTrack.id);
                    break;
                case '+':
                    showAddModal();
                    break;
                case 'Escape':
                    hideAddModal();
                    break;
                case 'l':
                case 'L':
                    const currentTrack = tracks[currentTrackIndex];
                    if (currentTrack) toggleLike(currentTrack.id);
                    break;
            }
        });
        
        // Initialize
        initMusicFeed();
        musicContainer.addEventListener('scroll', handleScroll);
        
        // Auto-play first track on load
        setTimeout(() => {
            autoPlayCurrentTrack();
        }, 1000);
        
        console.log('ðŸŽµ SoundScroll iniciado!');
        console.log('ðŸŽ¹ Atalhos:');
        console.log('- Setas â†‘â†“: Navegar entre mÃºsicas');
        console.log('- EspaÃ§o: Play/Pause');
        console.log('- +: Adicionar nova mÃºsica');
        console.log('- L: Curtir mÃºsica atual');
        console.log('- Esc: Fechar modal');
    </script>
</body>
</html>